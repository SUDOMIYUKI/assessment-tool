# 不登校支援 初回アセスメント支援ツール（改善版）

面談メモからAIが自動でアセスメントシートと報告書を生成するデスクトップアプリケーション

## 🚀 改善点

- ✅ エラーハンドリング強化
- ✅ API リトライ機能追加
- ✅ パス処理の統一（Pathオブジェクト使用）
- ✅ JSON解析の堅牢性向上
- ✅ データベースインデックス追加
- ✅ マルチスレッド対応（UIフリーズ防止）
- ✅ クロスプラットフォーム対応

## セットアップ

### 1. 仮想環境作成

```bash
python -m venv venv

# Windows
venv\Scripts\activate

# Mac/Linux
source venv/bin/activate
```

### 2. ライブラリインストール

```bash
pip install -r requirements.txt
```

### 3. 環境変数設定

`.env`ファイルを作成：

```
CLAUDE_API_KEY=your_api_key_here
```

### 4. テンプレート配置

`templates/`ディレクトリに以下を配置：
- アセスメントシート原本.xlsx

### 5. 起動

```bash
python main.py
```

## 使い方

1. 基本情報を入力
2. 通院状況を入力（該当する場合）
3. 面談メモを自由に記録
4. 「AI分析を実行」をクリック
5. 結果を確認
   - アセスメントシート：Excelに自動出力
   - 報告書テキスト：コピーして使用

## トラブルシューティング

### エラー: テンプレートが見つかりません
→ `templates/`ディレクトリにExcelファイルを配置してください

### エラー: APIキーが設定されていません
→ `.env`ファイルを作成し、APIキーを設定してください

### エラー: レート制限
→ 自動でリトライします。しばらくお待ちください

### エラー: JSON解析失敗
→ 自動でフォールバック処理が実行されます

