# 自動アップデート機能の使い方

## 📋 概要

アプリは起動時に自動的にDropbox上の最新版をチェックし、更新がある場合は通知を表示します。
更新を承認すると、自動的にアプリが更新され、再起動されます。

## 🚀 セットアップ手順

### 1. Dropbox上に「最新版」フォルダを作成

以下のパスにフォルダを作成してください：
```
Dropbox/不登校支援ツール/最新版/
```

### 2. 最新版のexeファイルを配置

ビルドした最新版の`不登校支援ツール.exe`を以下の場所にコピー：
```
Dropbox/不登校支援ツール/最新版/不登校支援ツール.exe
```

### 3. 各PCでアプリを起動

各PCでアプリを起動すると、自動的に更新をチェックします。

## 🔄 更新の流れ

1. **起動時チェック**
   - アプリ起動時に、バックグラウンドで更新をチェック
   - Dropbox上の`最新版/不登校支援ツール.exe`と現在のexeを比較

2. **更新通知**
   - 新しいバージョンがある場合、ダイアログで通知
   - 「はい」を選択すると更新を開始

3. **自動更新**
   - アプリを終了
   - 現在のexeをバックアップ（`不登校支援ツール_old.exe`）
   - 新しいexeに置き換え
   - 自動的にアプリを再起動

## ⚙️ 設定

`config.py`で自動アップデートの設定を変更できます：

```python
# 自動アップデートを有効/無効
UPDATE_CHECK_ENABLED = True

# 更新ファイルのパス（自動検出）
# Dropboxが有効な場合、自動的に設定されます
UPDATE_SOURCE_PATH = dropbox_path / '不登校支援ツール' / '最新版' / '不登校支援ツール.exe'
```

## 📝 注意事項

- **同時更新を避ける**: 複数のPCで同時に更新しないでください
- **Dropbox同期を確認**: 更新ファイルを配置した後、Dropboxの同期が完了するまで待ってください
- **バックアップ**: 更新前に現在のexeが`不登校支援ツール_old.exe`としてバックアップされます
- **エラー時の復元**: 更新に失敗した場合、バックアップから自動的に復元されます

## 🔧 トラブルシューティング

### 更新通知が表示されない

1. Dropboxの同期が完了しているか確認
2. `Dropbox/不登校支援ツール/最新版/不登校支援ツール.exe`が存在するか確認
3. 更新ファイルの更新日時が現在のexeより新しいか確認

### 更新に失敗する

1. アプリが完全に終了しているか確認
2. ファイルのアクセス権限を確認
3. バックアップファイル（`不登校支援ツール_old.exe`）から手動で復元

### 手動更新

自動更新がうまく動作しない場合は、手動で更新できます：

1. アプリを終了
2. `Dropbox/不登校支援ツール/最新版/不登校支援ツール.exe`をコピー
3. 現在のexeファイルを置き換え
4. アプリを再起動

## ✅ チェックリスト

- [ ] Dropbox上に`不登校支援ツール/最新版/`フォルダを作成
- [ ] 最新版のexeを配置
- [ ] Dropboxの同期が完了していることを確認
- [ ] 各PCでアプリを起動して更新を確認

## 🎉 完成！

これで、新しいバージョンをビルドしてDropboxに配置するだけで、全PCで自動的に更新通知が表示されます。

