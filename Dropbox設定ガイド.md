# Dropbox設定ガイド

## ⚠️ 重要な注意事項

**手動でDropboxからファイルをダウンロードする必要はありません！**

各PCでDropboxアプリをインストールして、自動同期を有効にしてください。
exeファイルはWebから直接開けないため、Dropboxアプリで自動同期する必要があります。

## 📋 正しい設定方法

### 1. 各PCにDropboxアプリをインストール（必須）

1. [Dropbox公式サイト](https://www.dropbox.com/)からDropboxアプリをダウンロード
2. 各PCにインストール
3. 同じDropboxアカウントでログイン
4. **重要**: これにより、各PCにDropboxフォルダが自動的に作成・同期されます

### 2. アプリとデータベースをDropboxに配置

#### 初回セットアップ（管理者側）

1. **配布版フォルダをDropboxに配置**
   ```
   Dropbox/不登校支援ツール/
   ├── 不登校支援ツール.exe
   ├── templates/
   │   └── アセスメントシート原本.xlsx
   └── 使い方.txt
   ```

2. **最新版フォルダも作成（自動アップデート用）**
   ```
   Dropbox/不登校支援ツール/最新版/
   └── 不登校支援ツール.exe
   ```

#### 各PCでの設定

1. **Dropboxアプリが自動同期していることを確認**
   - タスクトレイのDropboxアイコンを確認
   - 「同期済み」と表示されていることを確認

2. **Dropboxフォルダ内のアプリを起動**
   - `Dropbox/不登校支援ツール/不登校支援ツール.exe` をダブルクリック
   - **重要**: 各PCで同じDropboxフォルダ内のアプリを起動してください

3. **データベースの自動作成**
   - アプリを起動すると、自動的に以下の場所にデータベースが作成されます：
   ```
   Dropbox/不登校支援ツール/data/records.db
   ```
   - このファイルはDropboxで自動同期されます

### 3. Dropboxフォルダの確認

各PCで以下のフォルダが存在することを確認：
```
C:\Users\[ユーザー名]\Dropbox\不登校支援ツール\
```

または
```
C:\Users\[ユーザー名]\Dropbox (Personal)\不登校支援ツール\
```

**重要**: このフォルダ内のファイルは自動的に全PCで同期されます。

## ❌ やってはいけないこと

1. **手動でDropboxからファイルをダウンロードして別の場所に保存**
   - 各PCが別々のコピーを使うことになり、同期されません
   - **正しい方法**: Dropboxアプリで自動同期し、Dropboxフォルダ内のアプリを直接起動

2. **Dropboxフォルダ外にアプリをコピー**
   - データベースがローカルに保存され、他のPCと共有されません
   - **正しい方法**: Dropboxフォルダ内のアプリを直接起動

3. **データベースファイルを手動でコピー**
   - データが分散し、最新の情報が反映されません
   - **正しい方法**: Dropboxアプリで自動同期

4. **複数のPCで同時に編集**
   - データベースロックエラーが発生する可能性があります

## ✅ 正しい使い方

1. **各PCでDropboxアプリをインストール・起動**
   - Dropboxフォルダが自動同期されていることを確認
   - タスクトレイのDropboxアイコンで「同期済み」を確認

2. **Dropboxフォルダ内のアプリを起動**
   - `Dropbox/不登校支援ツール/不登校支援ツール.exe` をダブルクリック
   - **重要**: 各PCで同じDropboxフォルダ内のアプリを起動してください
   - 初回起動時に自動的にデータベースが作成されます
   - 既に他のPCで作成されている場合は、自動的に同期されます

3. **データを編集**
   - 編集後、Dropboxの同期が完了するまで待ってください
   - 他のPCでも自動的に反映されます（5分ごとに自動リフレッシュ）

## 🔍 確認方法

### Dropboxの同期状態を確認

1. Dropboxアイコン（タスクトレイ）をクリック
2. 「同期中」または「同期済み」と表示されていることを確認
3. 同期が完了していない場合は、完了するまで待ってください

### データベースファイルの場所を確認

アプリ起動時に、コンソールに以下のメッセージが表示されます：
```
✅ データベースをDropboxに保存します: [パス]
```

このパスがDropboxフォルダ内であることを確認してください。

## 🚨 トラブルシューティング

### 問題: データが他のPCに反映されない

**原因**: Dropboxの同期が完了していない、または手動でコピーしている

**解決方法**:
1. Dropboxの同期状態を確認
2. 手動でコピーしていないか確認
3. 各PCで同じDropboxフォルダを参照しているか確認

### 問題: データベースロックエラー

**原因**: 複数のPCで同時に編集している

**解決方法**:
1. 他のPCでアプリを閉じる
2. Dropboxの同期が完了するまで待つ
3. 再度アプリを起動

### 問題: Dropboxフォルダが見つからない

**原因**: Dropboxアプリがインストールされていない、または別の場所にインストールされている

**解決方法**:
1. Dropboxアプリをインストール
2. `config.py`でDropboxパスを確認
3. 必要に応じて手動でパスを設定

## 📝 まとめ

### 初回セットアップ
1. ✅ 各PCにDropboxアプリをインストール
2. ✅ 管理者が配布版フォルダをDropboxに配置
3. ✅ 各PCでDropboxフォルダ内のアプリを起動

### 日常的な使い方
- ✅ Dropboxアプリで自動同期を有効にする
- ✅ Dropboxフォルダ内のアプリを直接起動（手動ダウンロード不要）
- ✅ 同期が完了してから操作する
- ✅ 同時に複数のPCで編集しない

### 更新時
- ✅ 管理者が最新版をDropboxの「最新版」フォルダに配置
- ✅ 各PCでアプリを起動すると自動更新通知が表示される
- ✅ 手動でダウンロード・配布する必要はありません

これで、全PCで同じデータベースを共有でき、更新も自動化されます！

