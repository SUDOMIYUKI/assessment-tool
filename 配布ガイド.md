# アプリ配布ガイド - 実行ファイル（.exe）作成

## 📋 概要

PyInstallerを使って、Pythonアプリを実行ファイル（.exe）に変換します。
他の支援員はPythonをインストールせずに、ダブルクリックで使えます。

## 🔧 準備

### 1. PyInstallerのインストール

```bash
pip install pyinstaller
```

### 2. プロジェクト構造の確認

以下のような構造になっていることを確認：

```
project/
├── main.py
├── config.py
├── app.spec              # PyInstaller設定ファイル
├── src/
│   ├── __init__.py
│   ├── database/
│   │   ├── __init__.py
│   │   ├── models.py
│   │   ├── history.py
│   │   └── staff.py
│   ├── ui/
│   │   ├── __init__.py
│   │   ├── smart_input_form.py
│   │   ├── preview_window.py
│   │   └── staff_manager.py
│   ├── utils/
│   │   └── (その他のユーティリティ)
│   └── excel/
│       ├── __init__.py
│       └── assessment_writer.py
├── templates/
│   └── アセスメントシート原本.xlsx
├── data/
│   └── (データベースファイル - 実行時に自動作成)
└── output/
    └── (出力ファイル - 実行時に自動作成)
```

## 🎯 実行ファイル作成手順

### ステップ1: specファイルの確認

`app.spec`ファイルがプロジェクトルートに存在することを確認します。
このファイルには必要な設定が含まれています。

### ステップ2: 実行ファイルをビルド

コマンドラインで実行：

```bash
pyinstaller app.spec
```

または、シンプルな方法（specファイルなし）：

```bash
pyinstaller --onefile --windowed --name="不登校支援ツール" --add-data="templates;templates" --add-data="src;src" main.py
```

### ステップ3: 生成された実行ファイルを確認

- `dist/`フォルダに`不登校支援ツール.exe`が生成されます
- サイズは100-200MB程度

### ステップ4: 動作確認

1. `dist/不登校支援ツール.exe`をダブルクリック
2. アプリが起動することを確認
3. 各機能が正常に動作することを確認

## 📦 配布パッケージの作成

### フォルダ構成

配布用のフォルダを作成：

```
不登校支援ツール_配布用/
├── 不登校支援ツール.exe
├── templates/
│   └── アセスメントシート原本.xlsx
├── data/
│   └── (空のフォルダ、または実行時に自動作成)
├── output/
│   └── (空のフォルダ、または実行時に自動作成)
├── 使い方.txt
└── README.txt
```

**重要**: `data/`フォルダと`output/`フォルダは、アプリが自動的に作成するため、空のフォルダでも構いません。

### 使い方.txtの内容

`配布用_使い方.txt`を参照してください。

## 🔒 配布方法

### 方法A: USBメモリで配布

1. 配布用フォルダをUSBメモリにコピー
2. 各支援員のPCにコピーしてもらう
3. 「不登校支援ツール.exe」を起動

### 方法B: ネットワーク共有フォルダ

1. 社内の共有フォルダに配布用フォルダを配置
2. 各支援員が自分のPCにコピー
3. 「不登校支援ツール.exe」を起動

### 方法C: メール添付（圧縮）

1. 配布用フォルダをZIPで圧縮
2. メールで送信
3. 解凍後、「不登校支援ツール.exe」を起動

⚠️ **注意**: ファイルサイズが大きい（100-200MB）ため、メールの添付ファイルサイズ制限に注意

## 🔐 セキュリティ上の注意

### 個人情報の取り扱い

1. **data/records.db**には個人情報が含まれます
2. 各支援員のPCで独立して管理
3. 定期的なバックアップを推奨
4. PC廃棄時はdata/フォルダを確実に削除

### データ共有について

- 基本的には各支援員が独立してデータ管理
- データ共有が必要な場合は、Excelファイルで共有
- データベースファイル（records.db）の直接共有は非推奨

## 📊 バージョン管理

### アップデート時の手順

1. 新しい.exeファイルを配布
2. 古い.exeファイルを新しいものに置き換え
3. **data/フォルダは残す**（上書きしない）
4. templates/フォルダは必要に応じて更新

### バージョン番号の管理

config.pyに以下を追加（すでに存在する場合もあり）：

```python
APP_VERSION = "1.0.0"
```

## ✅ チェックリスト

配布前の最終チェック：

- [ ] .exeファイルが起動する
- [ ] 面談記録の入力ができる
- [ ] アセスメントシートが生成される
- [ ] 支援員管理機能が動作する
- [ ] data/フォルダが自動作成される
- [ ] output/フォルダが自動作成される
- [ ] 使い方.txtが同梱されている
- [ ] templates/フォルダが同梱されている

## 🎉 完成！

これで他の支援員にも配布できるアプリが完成です。

【配布の流れ】
1. PyInstallerで.exeを作成
2. 配布用フォルダを準備
3. USBやネットワークで配布
4. 各自のPCで起動

質問や問題があればお気軽にお問い合わせください！

